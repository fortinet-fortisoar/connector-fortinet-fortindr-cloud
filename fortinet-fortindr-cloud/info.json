{
  "name": "fortinet-fortindr-cloud",
  "label": "Fortinet FortiNDR Cloud",
  "version": "1.0.0",
  "description": "Fortinet FortiNDR Cloud is a cloud-native network detection and response solution built for the rapid detection of threat activity, investigation of suspicious behavior, proactive hunting for potential risks, and directing a fast and effective response to active threats. This connector facilitates automated operation related to detection, entity, and sensors.",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "category": "Cloud Security",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "ingestion_supported": true,
  "ingestion_modes": [
    "scheduled"
  ],
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.0.0/fortinet-fortindr-cloud/545/fortinet-fortindr-cloud-v-1-0-0",
  "configuration": {
    "fields": [
      {
        "title": "API Token",
        "description": "Specify the API Token used to access the FortiNDR Cloud APIs and perform the automated operations.",
        "type": "password",
        "name": "api_key",
        "required": true,
        "editable": true,
        "visible": true
      },
      {
        "title": "Account UUID",
        "description": "Specify the UUID of the account used to access FortiNDR Cloud and perform the automated operations.",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "account_uuid"
      },
      {
        "title": "Verify SSL",
        "description": "Specifies whether the SSL certificate for the server is to be verified or not.",
        "name": "verify_ssl",
        "type": "checkbox",
        "required": false,
        "editable": true,
        "visible": true,
        "value": true
      }
    ]
  },
  "operations": [
    {
      "operation": "get_pcap_tasks",
      "title": "Get PCAP Tasks",
      "description": "Retrieves a list of all the PCAP tasks or specific PCAP tasks from FortiNDR Cloud based on the input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_pcap_tasks",
      "enabled": true,
      "parameters": [
        {
          "title": "Task UUID",
          "description": "Specify the UUID of the task based on which you want to retrieve PCAP tasks from FortiNDR Cloud.\nNote: If you specify the Task UUID, then you do not need to specify any other parameters.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "task_uuid",
          "tooltip": "Specify the UUID of the task based on which you want to retrieve pcap tasks from FortiNDR cloud. Note: If you are specifying Task UUID no need to specify all parameters."
        },
        {
          "title": "Sensor ID",
          "description": "Specify the sensor ID based on which you want to retrieve PCAP tasks from FortiNDR Cloud",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "sensor_id",
          "tooltip": "Only pull PCAPs captured on the specified sensor."
        },
        {
          "title": "Created Start DateTime",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "created_start",
          "tooltip": "Earliest date a task can have been created."
        },
        {
          "title": "Created End DateTime",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created before the specified timestamp.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "created_end",
          "tooltip": "Latest date a task can have been created."
        },
        {
          "title": "Search Text",
          "description": "Specify the text based on which you want to search for PCAP tasks from FortiNDR Cloud. In this case, this operation returns only those PCAP tasks that contain the specified string in their descriptions or names.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "search_text",
          "tooltip": "Only return tasks with the provided string in their descriptions or names."
        },
        {
          "title": "Include Hash Files",
          "description": "Select this checkbox to only return those PCAP tasks that contain Hash files. By default, this option is selected, i.e. set to 'True'.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "has_files_only",
          "value": true,
          "tooltip": "Indicates to only return tasks with PCAP files. By default, this option is set as true"
        },
        {
          "title": "Page Size",
          "description": "Specify the maximum count of records that you want this operation to fetch from FortiNDR Cloud. By default, this option is set to 100, and you can set a maximum value of 1000.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "page_size",
          "value": 100,
          "tooltip": "Specify the maximum count of records that you want this operation to fetch from FortiNDR cloud. By default, this option is set as 100 and maximum we can set as 1000."
        },
        {
          "title": "Page Number",
          "description": "Specify the page from which you want this operation to return results based on the page size. By default, this option is set as '1'. For example, if you set this as '2' and retain the page size as 100, then the operation will return 100 results from the 2nd page.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "page_num",
          "value": 1,
          "tooltip": "The page to offset from based on the Page Size. By default, this option is set as 1"
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{task_uuid !== ''}}",
          "output_schema": {
            "pcaptasks": [
              {
                "task_uuid": "",
                "description": "",
                "name": "",
                "sensor_ids": [],
                "account_code": "",
                "bpf": "",
                "created_uuid": "",
                "updated_uuid": "",
                "created_email": "",
                "updated_email": "",
                "created": "",
                "updated": "",
                "requested_start_time": "",
                "requested_end_time": "",
                "actual_start_time": "",
                "actual_end_time": "",
                "status": "",
                "files": [],
                "has_files": ""
              }
            ],
            "result_count": ""
          }
        },
        {
          "condition": "{{task_uuid === ''}}",
          "output_schema": {
            "pcap_task": {
              "task_uuid": "",
              "description": "",
              "name": "",
              "sensor_ids": [],
              "account_code": "",
              "bpf": "",
              "created_uuid": "",
              "updated_uuid": "",
              "created_email": "",
              "updated_email": "",
              "created": "",
              "updated": "",
              "requested_start_time": "",
              "requested_end_time": "",
              "actual_start_time": "",
              "actual_end_time": "",
              "status": "",
              "files": [],
              "has_files": ""
            }
          }
        }
      ]
    },
    {
      "operation": "download_pcap_task_file",
      "title": "Download PCAP Task File",
      "description": "Downloads a specific PCAP task file generated by the specified task from FortiNDR Coud based on the task UUID, and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "download_pcap_task_file",
      "enabled": true,
      "parameters": [
        {
          "title": "Task UUID",
          "description": "Specify the UUID of the task whose associated PCAP task file you want to download from FortiNDR Cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "task_uuid",
          "tooltip": "Specify the UUID of the task based on which you want to download pcap task file from FortiNDR cloud."
        },
        {
          "title": "File Name",
          "description": "(Optional) Specify the name of the file that you want to assign to the PCAP task file downloaded from FortiNDR Cloud.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "file_name",
          "tooltip": "Specify the name of the file based on which you want to download pcap task from FortiNDR cloud."
        }
      ],
      "output_schema": {}
    },
    {
      "operation": "terminate_pcap_task",
      "title": "Terminate PCAP Task",
      "description": "Stops a specific, currently running, PCAP task on FortiNDR Cloud based on the task UUID that you have specified.",
      "category": "investigation",
      "annotation": "terminate_pcap_task",
      "enabled": true,
      "parameters": [
        {
          "title": "Task UUID",
          "description": "Specify the UUID of the currently running PCAP task that you want to stop on FortiNDR Cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "task_uuid",
          "tooltip": "Specify the UUID of the task based on which you want to stop pcap task from FortiNDR cloud."
        }
      ],
      "output_schema": {
        "message": ""
      }
    },
    {
      "operation": "delete_pcap_task",
      "title": "Delete PCAP Task",
      "description": "Permanently removes a specific PCAP task and all its associated files from FortiNDR Cloud based on the task UUID that you have specified.",
      "category": "investigation",
      "annotation": "delete_pcap_task",
      "enabled": true,
      "parameters": [
        {
          "title": "Task UUID",
          "description": "Specify the UUID of the PCAP task that you want to remove from FortiNDR Cloud. This operation will delete the specific PCAP task and all its associated files from FortiNDR Cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "task_uuid",
          "tooltip": "Specify the UUID of the task based on which you want to remove pcap task from FortiNDR cloud."
        }
      ],
      "output_schema": {
        "message": ""
      }
    },
    {
      "operation": "get_sensors",
      "title": "Get Sensors List",
      "description": "Retrieves a list of all sensors or specific sensors from FortiNDR Cloud based on the input parameters that you have specified.",
      "category": "investigation",
      "annotation": "get_sensors",
      "enabled": true,
      "parameters": [
        {
          "title": "Sensor ID",
          "description": "Specify the UUID of the sensor based on which you want to retrieve the specific sensor from FortiNDR Cloud.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "sensor_id",
          "tooltip": "Fetch the specified sensor."
        },
        {
          "title": "Account Code",
          "description": "Specify the code of the account based on which you want to retrieve sensors from FortiNDR Cloud.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "account_code",
          "tooltip": "Fetch sensors from the specified account."
        },
        {
          "title": "Include",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "multiselect",
          "name": "include",
          "description": "Choose additional parameters (metadata) that you want to include in the results. You can choose one, more than one, or all of the following values: Status or Interfaces.",
          "options": [
            "Status",
            "Interfaces"
          ],
          "tooltip": "Include additional metadata: Status, Interfaces"
        }
      ],
      "output_schema": {
        "result_count": "",
        "sensors": [
          {
            "created": "",
            "updated": "",
            "disabled": "",
            "sensor_id": "",
            "account_code": "",
            "location": {
              "latitude": "",
              "longitude": ""
            },
            "subdivision": "",
            "city": "",
            "country": "",
            "pcap_enabled": "",
            "tags": [],
            "serial_number": "",
            "status": "",
            "interfaces": "",
            "admin": ""
          }
        ]
      }
    },
    {
      "operation": "get_telemetry_events",
      "title": "Get Telemetry Events",
      "description": "Retrieves details for all telemetry events or specific telemetry events from FortiNDR Cloud based on the input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_telemetry_events",
      "enabled": true,
      "parameters": [
        {
          "title": "Sensor ID",
          "description": "Specify the ID of the sensor based on which you want to retrieve telemetry events from FortiNDR Cloud.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "sensor_id",
          "tooltip": "Fetch telemetry for the specified sensor."
        },
        {
          "title": "Account Code",
          "description": "Specify the code of the account based on which you want to retrieve telemetry events from FortiNDR Cloud.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "account_code",
          "tooltip": "Fetch telemetry for the specified account."
        },
        {
          "title": "Interval",
          "description": "Choose the interval based on which you want to retrieve telemetry events from FortiNDR Cloud. You can choose between Hour (default) or Day.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "interval",
          "options": [
            "Hour",
            "Day"
          ],
          "value": "Hour",
          "tooltip": "Time interval to group data by: Hour, Day. By default, this option is set as Hour"
        },
        {
          "title": "Start DateTime",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp.\nNote: The default is 1 day ago if you have selected the interval as Hour or 30 days ago if you have selected the interval as Day.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "start_date",
          "tooltip": "Earliest time to pull telemetry for. Note: 1 day for hourly interval, 30 days for daily interval."
        },
        {
          "title": "End DateTime",
          "description": "Select the DateTme using which you want to filter the result set to only include only those items that have been created before the specified timestamp.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "end_date",
          "tooltip": "Latest time to pull telemetry for."
        },
        {
          "title": "Event Type",
          "description": "Select the type of telemetry events you want to retrieve from FortiNDR Cloud. You can choose from values such as Flow, DNS, HTTP, SSL, X509, etc.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "event_type",
          "options": [
            "DHCP",
            "DNS",
            "Flow",
            "FTP",
            "HTTP",
            "X509",
            "DCE RPC",
            "Kerberos",
            "Notice",
            "NTLM",
            "Observation",
            "PE",
            "RDP",
            "SMB Files",
            "SMB Mapping",
            "SMTP",
            "Software",
            "SSH",
            "SSL",
            "Suricata",
            "Tunnel"
          ],
          "tooltip": "Only return telemetry for the specified event type."
        },
        {
          "title": "Group By",
          "description": "Select the criteria that you want to use to group telemetry events retrieved from FortiNDR Cloud. You can choose between Sensor ID or Event Type.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "group_by",
          "options": [
            "Sensor ID",
            "Event Type"
          ],
          "tooltip": "Optionally group by a specified field: Sensor ID, Event Type."
        }
      ],
      "output_schema": {
        "result_count": "",
        "columns": [],
        "data": []
      }
    },
    {
      "operation": "get_telemetry_bandwidth",
      "title": "Get Telemetry Bandwidth",
      "description": "Retrieves details of telemetry bandwidth from FortiNDR Cloud based on the input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_telemetry_bandwidth",
      "enabled": true,
      "parameters": [
        {
          "title": "Account Code",
          "description": "Specify the code of the account based on which you want to retrieve network telemetry from FortiNDR Cloud.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "account_code",
          "tooltip": "Fetch network usage telemetry for the specified account."
        },
        {
          "title": "Start DateTime",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "start_date",
          "tooltip": "The start date to filter the network usage telemetry."
        },
        {
          "title": "End DateTime",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created before the specified timestamp.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "end_date",
          "tooltip": "The end date to filter the network usage telemetry."
        },
        {
          "title": "Interval",
          "description": "Choose the interval based on which you want to retrieve network telemetry from FortiNDR Cloud. You can choose between Day or Month to Day.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "interval",
          "options": [
            "Day",
            "Month to Day"
          ],
          "tooltip": "Interval to group network usage telemetry by: Day, Month to Day."
        },
        {
          "title": "Latest Month",
          "description": "Specify this parameter if you want to filter out the network usage telemetry for all days, except the latest day and month_to_date for each month.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "latest_each_month",
          "tooltip": "Filters out the network usage telemetry for all days, except the latest day and month_to_date for each month."
        },
        {
          "title": "Sort Order",
          "description": "Select the sorting order of the result. You can choose between Ascending or Descending (default).",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "sort_order",
          "options": [
            "Ascending",
            "Descending"
          ],
          "value": "Descending",
          "tooltip": "Sorts the network usage telemetry by account code, and then by timestamp. By default, this option is set as Descending"
        },
        {
          "title": "Limit",
          "description": "Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 1000.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 1000,
          "tooltip": "The maximum number of records to return. By default, this option is set as 1000"
        },
        {
          "title": "Offset",
          "description": "Index of the first item to be returned by this operation. This parameter is useful for pagination and for getting a subset of items. By default, this is set as 0",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "offset",
          "value": 0,
          "tooltip": "The number of records to skip past. By default, this option is set as 0"
        }
      ],
      "output_schema": {
        "result_count": "",
        "total_count": "",
        "network_usage": [
          {
            "account_code": "",
            "percentile_bps": "",
            "percentile": "",
            "interval": "",
            "timestamp": ""
          }
        ],
        "sort_order": "",
        "limit": "",
        "offset": ""
      }
    },
    {
      "operation": "get_telemetry_packetstats",
      "title": "Get Telemetry Packetstats",
      "description": "Retrieves details for telemetry packetstats from FortiNDR Cloud based on the input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_telemetry_packetstats",
      "enabled": true,
      "parameters": [
        {
          "title": "Sensor ID",
          "tooltip": "Fetch telemetry for the specified sensor.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "sensor_id",
          "description": "Specify the ID of the sensor based on which you want to retrieve telemetry packetstats from FortiNDR Cloud."
        },
        {
          "title": "Interval",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "interval",
          "description": "Choose the interval based on which you want to retrieve telemetry packetstats from FortiNDR Cloud. You can choose between Hour (default) or Day.",
          "options": [
            "Hour",
            "Day"
          ],
          "value": "Hour",
          "tooltip": "Time interval to group data by: Hour, Day. By default, this option is set as Hour"
        },
        {
          "title": "Start DateTime",
          "tooltip": "Earliest time to pull telemetry for. Note: 1 day for hourly interval, 30 days for daily interval",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "start_date",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp.\nNote: The default is 1 day ago if you have selected the interval as 'Hour' or 30 days ago if you have selected the interval as 'Day'."
        },
        {
          "title": "End DateTime",
          "tooltip": "Latest time to pull telemetry for.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "end_date",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created before the specified timestamp."
        },
        {
          "title": "Group By",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "group_by",
          "description": "Select Sensor ID as the criteria to group telemetry packetstats retrieved from FortiNDR Cloud.",
          "options": [
            "Sensor ID"
          ],
          "tooltip": "Optionally group by a specified field: Sensor ID"
        }
      ],
      "output_schema": {
        "result_count": "",
        "columns": "",
        "data": [
          {
            "timestamp": "",
            "sensor_id": "",
            "account_code": "",
            "interface_name": "",
            "tx_bytes": "",
            "tx_packets": "",
            "tx_errors": "",
            "rx_bytes": "",
            "rx_packets": "",
            "rx_errors": "",
            "rx_bits_per_second": ""
          }
        ]
      }
    },
    {
      "operation": "get_entity_tracking",
      "title": "Get Entity Tracking",
      "description": "Retrieves information about an IP address, MAC address, or Host name from FortiNDR Cloud based on the entity type and value and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_entity_tracking",
      "enabled": true,
      "parameters": [
        {
          "title": "Entity Type",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "entity_type",
          "description": "Select the type of entity whose tracking information you want to retrieve from FortiNDR Cloud. You can choose between IP Address (default), MAC Address, or Host Name.",
          "options": [
            "IP Address",
            "MAC Address",
            "Host Name"
          ],
          "value": "IP Address",
          "tooltip": "Type of the entity tracking by a specified field: IP Address, MAC Address, Host Name. By default, this option is set as IP Address"
        },
        {
          "title": "Entity Value",
          "tooltip": "Specify the value of the entity based on which you want to retrieve entity tracking from FortiNDR cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "entity_value",
          "description": "Specify the value of the entity (based on the entity type you have selected) whose tracking information you want to retrieve from FortiNDR Cloud",
          "placeholder": "E.g 1.1.1.1, google.com, etc."
        },
        {
          "title": "Start DateTime",
          "tooltip": "The start time (inclusive) of the DHCP interval to query by.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "start_time",
          "description": "(Optional) Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp."
        },
        {
          "title": "End DateTime",
          "tooltip": "The end time (inclusive) of the DHCP interval to query by.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "end_time",
          "description": "(Optional) Select the DateTime using which you want to filter the result set to only include only those items that have been created before the specified timestamp."
        },
        {
          "title": "Limit",
          "description": "(Optional) Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 100.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 100,
          "tooltip": "Maximum number of DHCP records to return. By default, this option is set as 100"
        },
        {
          "title": "Offset",
          "description": "(Optional) Index of the first item to be returned by this operation. This parameter is useful for pagination and for getting a subset of items. By default, this is set as 0.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "offset",
          "value": 0,
          "tooltip": "The index to continue paging records at. By default, this option is set as 0"
        }
      ],
      "output_schema": {
        "entity_tracking_response": {
          "limit": "",
          "total": "",
          "offset": "",
          "dhcp_mac_ip_intervals": []
        }
      }
    },
    {
      "operation": "get_entity_summary",
      "title": "Get Entity Summary",
      "description": "Retrieves summary information about an IP address or domain from FortiNDR Cloud based on the IP address or Domain you have specified.",
      "category": "investigation",
      "annotation": "get_entity_summary",
      "enabled": true,
      "parameters": [
        {
          "title": "IP/Domain",
          "tooltip": "Specify the IP/Domain based on which you want to retrieve entity summary from FortiNDR cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "entity",
          "description": "Specify the IP address or Domain for which you want to retrieve summary information from FortiNDR Cloud."
        }
      ],
      "output_schema": {
        "query_type": "",
        "summary": {
          "entity": "",
          "first_seen": "",
          "last_seen": "",
          "prevalence_count_internal": "",
          "tags": []
        }
      }
    },
    {
      "operation": "get_entity_pdns",
      "title": "Get Passive DNS Details",
      "description": "Retrieves passive DNS information about an IP address or domain from FortiNDR Cloud based on the IP address or Domain and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_entity_pdns",
      "enabled": true,
      "parameters": [
        {
          "title": "IP/Domain",
          "tooltip": "Specify the IP/Domain based on which you want to retrieve entity passive DNS from FortiNDR cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "entity",
          "description": "Specify the IP address Domain based on which you want to retrieve passive DNS details from FortiNDR Cloud."
        },
        {
          "title": "Record Type",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "record_type",
          "description": "Select the type of record based on which you want to retrieve entity passive DNS details from FortiNDR Cloud. You can choose from the following options: A, AAAA, CNAME, MX, or NS.",
          "options": [
            "A",
            "AAAA",
            "CNAME",
            "MX",
            "NS"
          ],
          "tooltip": "Limits records to only the specified types. Supported types: A, AAAA, CNAME, MX, NS."
        },
        {
          "title": "Start DateTime",
          "tooltip": "The earliest date to include records for (inclusive).",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "start_date",
          "description": "(Optional) Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp."
        },
        {
          "title": "End DateTime",
          "tooltip": "The latest date to include records for (inclusive).",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "end_date",
          "description": "(Optional) Select the DateTime using which you want to filter the result set to only include only those items that have been created before the specified timestamp."
        },
        {
          "title": "Limit",
          "description": "Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 1000.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 1000,
          "tooltip": "The maximum number of records to return. By default, this option is set as 1000"
        }
      ],
      "output_schema": {
        "query_type": "",
        "result_count": "",
        "passivedns": [
          {
            "resolved": "",
            "first_seen": "",
            "last_seen": "",
            "record_type": "",
            "source": "",
            "customer_id": "",
            "account_uuid": "",
            "sensor_id": ""
          }
        ]
      }
    },
    {
      "operation": "get_detections",
      "title": "Get Detections List",
      "description": "Retrieves a list of all detections or specific detections from FortiNDR Cloud based on the input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_detections",
      "enabled": true,
      "parameters": [
        {
          "title": "Rule UUID",
          "tooltip": "Only include detections with the specified rule.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "rule_uuid",
          "description": "Specify the UUID of the rule based on which you want to retrieve detections from FortiNDR Cloud."
        },
        {
          "title": "Sensor ID",
          "tooltip": "Only include detections with the specified sensor_id.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "sensor_id",
          "description": "Specify the ID of the sensor based on which you want to retrieve detections from FortiNDR Cloud."
        },
        {
          "title": "Status",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "multiselect",
          "name": "status",
          "description": "Select the status of the detection based on which you want to retrieve detections from FortiNDR Cloud. You can choose one, more than one, or all of the following values: Active (default) or Resolved.",
          "options": [
            "Active",
            "Resolved"
          ],
          "tooltip": "Only include detections with the specified status: Active, Resolved."
        },
        {
          "title": "Device IP",
          "tooltip": "Only include detections with the specified device IP.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "device_ip",
          "description": "Specify the device IP address if you want to include only those detections associated with the specified device IP."
        },
        {
          "title": "Muted",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "muted",
          "description": "Select this checkbox if you want this operation to return only those detections that are muted. By default, this option is cleared, i.e., set as 'false'.",
          "value": false,
          "tooltip": "Filter detections by whether or not the detection is muted. By default, this option is set as false"
        },
        {
          "title": "Muted Device",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "muted_device",
          "description": "Select this checkbox if you want this operation to return only those detections whose associated devices are muted. By default, this option is cleared, i.e., set as 'false'.",
          "value": false,
          "tooltip": "Filter detections by whether the device is muted. By default, this option is set as false"
        },
        {
          "title": "Muted Rule",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "muted_rule",
          "description": "Select this checkbox if you want this operation to return only those detections whose associated rules are muted. By default, this option is cleared, i.e., set as 'false'.",
          "value": false,
          "tooltip": "Filter detections by whether the rule is muted. By default, this option is set as false"
        },
        {
          "title": "Include",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "multiselect",
          "name": "include",
          "description": "Choose to include verbose data for linked objects in the results. You can choose one, or more than one, or all of the following values: Rules or Indicators.",
          "options": [
            "Rules",
            "Indicators"
          ],
          "tooltip": "Include verbose data for linked objects. Supported values: Rules, Indicators."
        },
        {
          "title": "Indicator Value",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "indicator_value",
          "description": "Specify an indicator value if you want to include only those detections associated with the specified indicator.",
          "tooltip": "Only include detections with the specified indicator."
        },
        {
          "title": "Created Start DateTime",
          "tooltip": "The earliest date that a detection could be created (inclusive).",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "created_start_date",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp."
        },
        {
          "title": "Created End DateTime",
          "tooltip": "The latest date that a detection could be created (exclusive).",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "created_end_date",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created before the specified timestamp."
        },
        {
          "title": "Sort By",
          "description": "Select the name of the field based on which you want to sort the result (detections) retrieved by this operation. You can choose from the following values: First Seen (default), Last Seen, Status, Device IP, or Indicator Count.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "sort_by",
          "options": [
            "First Seen",
            "Last Seen",
            "Status",
            "Device IP",
            "Indicator Count"
          ],
          "value": "First Seen",
          "tooltip": "Field to sort by: First Seen, Last Seen, Status, Device IP, Indicator Count. By default, this option is set as First Seen."
        },
        {
          "title": "Sort Order",
          "description": "Select the sorting order of the result. You can choose between Ascending or Descending (default).",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "sort_order",
          "options": [
            "Ascending",
            "Descending"
          ],
          "value": "Descending",
          "tooltip": "Direction of sort: Ascending, Descending. By default, this option is set as Descending"
        },
        {
          "title": "Limit",
          "description": "Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 100.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 100,
          "tooltip": "The maximum number of records to return. By default, this option is set as 100"
        },
        {
          "title": "Offset",
          "description": "Index of the first item to be returned by this operation. This parameter is useful for pagination and for getting a subset of items. By default, this is set as 0.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "offset",
          "value": 0,
          "tooltip": "The number of detections to skip. By default, this option is set as 0"
        }
      ],
      "output_schema": {
        "limit": "",
        "rules": [
          {
            "name": "",
            "uuid": "",
            "created": "",
            "enabled": "",
            "updated": "",
            "category": "",
            "severity": "",
            "confidence": "",
            "description": "",
            "specificity": "",
            "account_uuid": "",
            "rule_accounts": [
              {
                "muted": "",
                "last_seen": "",
                "first_seen": "",
                "account_uuid": "",
                "query_filter": "",
                "muted_comment": "",
                "detection_count": "",
                "muted_timestamp": "",
                "muted_user_uuid": "",
                "detection_muted_count": "",
                "detection_resolved_count": ""
              }
            ],
            "source_excludes": [],
            "critical_updated": "",
            "query_signature": "",
            "device_ip_fields": [],
            "indicator_fields": [],
            "created_user_uuid": "",
            "primary_attack_id": "",
            "run_account_uuids": [],
            "updated_user_uuid": "",
            "secondary_attack_id": "",
            "shared_account_uuids": [],
            "auto_resolution_minutes": ""
          }
        ],
        "offset": "",
        "sort_by": "",
        "detections": [
          {
            "uuid": "",
            "muted": "",
            "status": "",
            "created": "",
            "updated": "",
            "hostname": "",
            "username": "",
            "device_ip": "",
            "last_seen": "",
            "rule_uuid": "",
            "sensor_id": "",
            "first_seen": "",
            "indicators": [
              {
                "field": "",
                "values": []
              }
            ],
            "muted_rule": "",
            "resolution": "",
            "event_count": "",
            "account_uuid": "",
            "muted_comment": "",
            "muted_timestamp": "",
            "muted_user_uuid": "",
            "muted_device_uuid": "",
            "resolution_comment": "",
            "resolution_timestamp": "",
            "resolution_user_uuid": ""
          }
        ],
        "sort_order": "",
        "total_count": "",
        "result_count": ""
      }
    },
    {
      "operation": "resolve_detection",
      "title": "Resolve Detection",
      "description": "Resolves a specific detection on FortiNDR Cloud based on the detection UUID, resolution, and comment (optional) you have specified.",
      "category": "investigation",
      "annotation": "resolve_detection",
      "enabled": true,
      "parameters": [
        {
          "title": "Detection UUID",
          "tooltip": "Specify the UUID of the detection based on which you want to resolve detections in FortiNDR cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "detection_uuid",
          "description": "Specify the UUID of the detection that you want to resolve in FortiNDR Cloud."
        },
        {
          "title": "Resolution",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "resolution",
          "description": "Select the resolution that you want to assign to the specified detection you want to resolve in FortiNDR Cloud. You can choose from the following values: True Positive Mitigated, True Positive No Action, False Positive, or Unknown",
          "options": [
            "True Positive Mitigated",
            "True Positive No Action",
            "False Positive",
            "Unknown"
          ],
          "tooltip": "The resolution state to apply: True Positive Mitigated, True Positive No Action, False Positive or Unknown"
        },
        {
          "title": "Comment",
          "tooltip": "Optional comment to attach to the detection.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resolution_comment",
          "description": "(Optional) Specify a comment that you want to associate with the specified detection you want to resolve in FortiNDR Cloud."
        }
      ],
      "output_schema": {
        "message": ""
      }
    },
    {
      "operation": "get_devices_with_detection",
      "title": "Get Devices with Detection",
      "description": "Retrieves a list of all devices with detection or specific devices with detection from FortiNDR Cloud based on the account UUID and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_devices_with_detection",
      "enabled": true,
      "parameters": [
        {
          "title": "Account UUID",
          "description": "Specify the UUID of the account based on which you want to retrieve devices with detections from FortiNDR Cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "account_uuid",
          "tooltip": "The account to pull devices for."
        },
        {
          "title": "Search",
          "tooltip": "Only include detections with the specified device IP.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "search",
          "description": "(Optional) Specify the device IP address if you want to include only those detections associated with the specified device IP."
        },
        {
          "title": "Muted",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "muted",
          "description": "(Optional) Select this checkbox if you want this operation to return only those devices with detections that are muted. By default, this option is cleared, i.e., set as 'false'.",
          "value": false,
          "tooltip": "Filter associated detections by whether or not the detection is muted. By default, this option is set as false"
        },
        {
          "title": "Muted Device",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "muted_device",
          "description": "(Optional) Select this checkbox if you want this operation to return only those devices with detections whose associated devices are muted.By default, this option is cleared, i.e., set as 'false'.",
          "value": false,
          "tooltip": "Filter by whether the device is muted. By default, this option is set as false"
        },
        {
          "title": "Muted Rule",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "muted_rule",
          "description": "(Optional) Select this checkbox if you want this operation to return only those devices with detections whose associated rules are muted.By default, this option is cleared, i.e., set as 'false'.",
          "value": false,
          "tooltip": "Filter associated detections by whether the rule is muted. By default, this option is set as false"
        },
        {
          "title": "Status",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "multiselect",
          "name": "status",
          "description": "(Optional) Select the status of the detections based on which you want to retrieve devices with detections from FortiNDR Cloud. You can choose one, more than one, or all of the following values: Active (default) or Resolved.",
          "options": [
            "Active",
            "Resolved"
          ],
          "tooltip": "Only include detections with the specified status: Active, Resolved."
        },
        {
          "title": "Sort By",
          "description": "(Optional) Select the name of the field based on which you want to sort the result (devices) retrieved by this operation. You can choose from the following values:Device IP, Detection Count, Last Seen (default), or Threat Score.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "sort_by",
          "options": [
            "IP",
            "Detection Count",
            "Last Seen",
            "Threat Score"
          ],
          "value": "Last Seen",
          "tooltip": "Field to sort by: IP, Detection Count, Last Seen, Threat Score. By default, this option is set as Last Seen"
        },
        {
          "title": "Sort Order",
          "description": "(Optional) Select the sorting order of the result. You can choose between Ascending or Descending (default).",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "sort_order",
          "options": [
            "Ascending",
            "Descending"
          ],
          "value": "Descending",
          "tooltip": "Direction of sort: Ascending, Descending. By default, this option is set as Descending"
        },
        {
          "title": "Limit",
          "description": "(Optional) Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 100.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 100,
          "tooltip": "The maximum number of records to return. By default, this option is set as 100"
        },
        {
          "title": "Offset",
          "description": "(Optional) Index of the first item to be returned by this operation. This parameter is useful for pagination and for getting a subset of items. By default, this is set as 0.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "offset",
          "value": 0,
          "tooltip": "The number of detections to skip. By default, this option is set as 0"
        }
      ],
      "output_schema": {
        "result_count": "",
        "total_count": "",
        "devices": [
          {
            "account_uuid": "",
            "device_ip": "",
            "threat_score": "",
            "detections_count": "",
            "last_seen": ""
          }
        ],
        "sort_by": "",
        "sort_order": "",
        "offset": "",
        "limit": ""
      }
    },
    {
      "operation": "get_detection_events",
      "title": "Get Detection Events",
      "description": "Retrieves a list of all detection events or specific detection events from FortiNDR Cloud based on the detection UUID and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_detection_events",
      "enabled": true,
      "parameters": [
        {
          "title": "Detection UUID",
          "description": "Specify the UUID of the detection based on which you want to retrieve events from FortiNDR Cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "detection_uuid",
          "tooltip": "UUID of the detection to fetch events for."
        },
        {
          "title": "Limit",
          "description": "(Optional) Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 100.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 100,
          "tooltip": "The maximum number of events to return. By default, this option is set as 100"
        },
        {
          "title": "Offset",
          "description": "(Optional) Index of the first item to be returned by this operation. This parameter is useful for pagination and for getting a subset of items. By default, this is set as 0.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "offset",
          "value": 0,
          "tooltip": "The number of events to skip past. By default, this option is set as 0"
        }
      ],
      "output_schema": {
        "events": [
          {
            "event": {
              "dst": {
                "ip": "",
                "asn": {
                  "asn": "",
                  "isp": "",
                  "org": "",
                  "asn_org": ""
                },
                "geo": {
                  "city": "",
                  "country": "",
                  "location": "",
                  "subdivision": ""
                },
                "pkts": "",
                "port": "",
                "internal": "",
                "ip_bytes": ""
              },
              "src": {
                "ip": "",
                "asn": "",
                "geo": "",
                "pkts": "",
                "port": "",
                "internal": "",
                "ip_bytes": ""
              },
              "uri": {
                "uri": "",
                "host": "",
                "path": "",
                "port": "",
                "query": "",
                "scheme": "",
                "fragment": ""
              },
              "host": {
                "ip": "",
                "asn": {
                  "asn": "",
                  "isp": "",
                  "org": "",
                  "asn_org": ""
                },
                "geo": {
                  "city": "",
                  "country": "",
                  "location": "",
                  "subdivision": ""
                },
                "pkts": "",
                "port": "",
                "internal": "",
                "ip_bytes": ""
              },
              "uuid": "",
              "files": [
                {
                  "md5": "",
                  "name": "",
                  "sha1": "",
                  "bytes": "",
                  "sha256": "",
                  "mime_type": ""
                }
              ],
              "intel": "",
              "method": "",
              "source": "",
              "flow_id": "",
              "headers": {
                "accept": "",
                "origin": "",
                "server": "",
                "refresh": "",
                "location": "",
                "content_md5": "",
                "content_type": "",
                "x_powered_by": "",
                "cookie_length": "",
                "proxied_client_ips": ""
              },
              "proxied": "",
              "info_msg": "",
              "referrer": "",
              "username": "",
              "sensor_id": "",
              "timestamp": "",
              "event_type": "",
              "status_msg": "",
              "user_agent": "",
              "application": "",
              "customer_id": "",
              "request_len": "",
              "status_code": "",
              "trans_depth": "",
              "geo_distance": "",
              "request_mime": "",
              "response_len": "",
              "request_mimes": "",
              "response_mime": "",
              "response_mimes": []
            },
            "rule_uuid": ""
          }
        ],
        "total_count": "",
        "result_count": ""
      }
    },
    {
      "operation": "get_detection_rule_indicators",
      "title": "Get Detection Rule Indicators",
      "description": "Retrieves a list of all detection rule indicators or specific detection rule indicators from FortiNDR Cloud based on the rule UUID and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_detection_rule_indicators",
      "enabled": true,
      "parameters": [
        {
          "title": "Rule UUID",
          "description": "Specify the UUID of the rule based on which you want to retrieve indicators from FortiNDR Cloud.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "rule_uuid",
          "tooltip": "UUID of the associated rule that produced the indicator. Note: Get \"Rule UUID\" value from \"Get All Detections List\" operation response."
        },
        {
          "title": "Detection Muted",
          "description": "Select this checkbox if you want this operation to return only those rule indicators whose associated detections are muted. By default, this option is cleared, i.e., set as'false'.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "detection_muted",
          "tooltip": "Filter by whether the detection was muted. By default, this option is set as false",
          "value": false
        },
        {
          "title": "Detection Status",
          "description": "Select the status of the detection based on which you want to retrieve rule indicators from FortiNDR Cloud. You can choose one, more than one, or all of the following values: Active (default) or Resolved.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "multiselect",
          "name": "detection_status",
          "options": [
            "Active",
            "Resolved"
          ],
          "tooltip": "Filter by the status of the detection: Active, Resolved."
        },
        {
          "title": "Sort By",
          "description": "Specify the name of the field based on which you want to sort the result (indicators) retrieved by this operation. By default, the results are sorted by the count field.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "sort_by",
          "value": "count",
          "tooltip": "The maximum number of events to return. By default, this option is set as count"
        },
        {
          "title": "Sort Order",
          "description": "Select the sorting order of the result. You can choose between Ascending or Descending (default)",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "sort_order",
          "options": [
            "Ascending",
            "Descending"
          ],
          "value": "Descending",
          "tooltip": "Sorting order of the result (indicators), choose between Ascending or Descending. By default, this option is set as Descending"
        },
        {
          "title": "Limit",
          "description": "Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 100.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 100,
          "tooltip": "The maximum number of events to return. By default, this option is set as 100"
        },
        {
          "title": "Offset",
          "description": "Index of the first item to be returned by this operation. This parameter is useful for pagination and for getting a subset of items. By default, this is set as 0.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "offset",
          "value": 0,
          "tooltip": "The number of events to skip past. By default, this option is set as 0"
        }
      ],
      "output_schema": {
        "limit": "",
        "offset": "",
        "sort_by": "",
        "sort_order": "",
        "rule_counts": [
          {
            "count": "",
            "field": "",
            "value": "",
            "rule_uuid": ""
          }
        ],
        "total_count": "",
        "result_count": ""
      }
    },
    {
      "operation": "get_detection_rules",
      "title": "Get Detection Rules List",
      "description": "Retrieves a list of all the detection rules or specific detection rules from FortiNDR Cloud based on the input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_detection_rules",
      "enabled": true,
      "parameters": [
        {
          "title": "Rule Account UUID",
          "tooltip": "Only include sub-objects for the specified account.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "rule_account_uuid",
          "description": "Specify the UUID of the rule account only if you want to include sub-objects for the specified account while retrieving detection rules from FortiNDR Cloud."
        },
        {
          "title": "Search By",
          "tooltip": "Only include rules with the string in name or category.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "search",
          "description": "Specify the text based on which you want to search for detection rules in FortiNDR Cloud. In this case, this operation returns only those rules that contain the specified string in their name or category."
        },
        {
          "title": "Has Detection",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "has_detections",
          "description": "Select this checkbox to only return those rules that have unmuted or unresolved detections. By default, this option is cleared, i.e., set as 'false'.",
          "value": false,
          "tooltip": "Only include rules that have unmuted, unresolved detections. By default, this option is set as false"
        },
        {
          "title": "Detection Device IP",
          "tooltip": "Only include rules with detections for the specified IP; associated detections are determined by the has_detections param.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "detection_device_ip",
          "description": "Specify the device IP address if you want to include only those rules with detections for the specified IP. Associated detections are determined by the has_detections parameter."
        },
        {
          "title": "Indicator Value",
          "tooltip": "Case insensitive prefix search of related indicators.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "indicator_value",
          "description": "Specify the case-insensitive prefix to be used for searching indicators that are related to the rules you want to retrieve from FortiNDR Cloud."
        },
        {
          "title": "Severity",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "multiselect",
          "name": "severity",
          "description": "Select the severity based on which you want to retrieve detection rules from FortiNDR Cloud. You can choose one, more than one, or all of the following values:Low, Moderate, or High.",
          "options": [
            "Low",
            "Moderate",
            "High"
          ],
          "tooltip": "List of severities to filter by: Low, Moderate, High."
        },
        {
          "title": "Confidence",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "multiselect",
          "name": "confidence",
          "description": "Select the confidence based on which you want to retrieve detection rules from FortiNDR Cloud. You can choose one, more than one, or all of the following values:Low, Moderate, or High.",
          "options": [
            "Low",
            "Moderate",
            "High"
          ],
          "tooltip": "List of confidences to filter by: Low, Moderate, High."
        },
        {
          "title": "Category",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "multiselect",
          "name": "category",
          "description": "Select the category based on which you want to retrieve detection rules from FortiNDR Cloud. You can choose one, or more than one, or all of the values such as Attack:Command and Control, Attack:Exploitation, PUA:Adware, etc.",
          "options": [
            "Attack:Command and Control",
            "Attack:Exploitation",
            "Attack:Exfiltration",
            "Attack:Installation",
            "Attack:Lateral Movement",
            "Attack:Infection Vector",
            "Attack:Miscellaneous",
            "Miscellaneous",
            "Posture:Anomalous Activity",
            "Posture:Insecure Configuration",
            "Posture:Potentially Unauthorized Software or Device",
            "Posture:Miscellaneous",
            "PUA:Adware",
            "PUA:Spyware",
            "PUA:Unauthorized Resource Use",
            "PUA:Miscellaneous"
          ],
          "tooltip": "Category to filter by."
        },
        {
          "title": "Include Muted Rules",
          "tooltip": "Include rules muted by the specified account.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "rule_account_muted",
          "description": "Select this checkbox if you want this operation to return onlythose rules that are muted by the specified account."
        },
        {
          "title": "Enabled",
          "tooltip": "Only include enabled rules. By default, this option is set as false",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "name": "enabled",
          "description": "Select this checkbox to only return those rules that are enabled. By default, this option is cleared, i.e., set as 'false'.",
          "value": false
        },
        {
          "title": "Sort By",
          "description": "Select the name of the field based on which you want to sort the result (rules) retrieved by this operation. You can choose from the following values: Created, Updated (default), Detections, Severity, Confidence, Category, Last Seen, or Detections Muted.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "sort_by",
          "options": [
            "Created",
            "Updated",
            "Detections",
            "Severity",
            "Confidence",
            "Category",
            "Last Seen",
            "Detections Muted"
          ],
          "value": "Updated",
          "tooltip": "The field to sort by: Created, Updated, Detections, Severity, Confidence, Category, Last Seen, Detections Muted. By default, this option is set as Updated"
        },
        {
          "title": "Sort Order",
          "description": "Select the sorting order of the result. You can choose between Ascending or Descending (default).",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "sort_order",
          "options": [
            "Ascending",
            "Descending"
          ],
          "value": "Descending",
          "tooltip": "The sort order: Ascending, Descending. By default, this option is set as Descending"
        },
        {
          "title": "Limit",
          "description": "Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 100.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 100,
          "tooltip": "The maximum number of records to return. By default, this option is set as 100"
        },
        {
          "title": "Offset",
          "description": "Index of the first item to be returned by this operation. This parameter is useful for pagination and for getting a subset of items. By default, this is set as 0.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "offset",
          "value": 0,
          "tooltip": "The number of records to skip past. By default, this option is set as 0"
        }
      ],
      "output_schema": {
        "result_count": "",
        "total_count": "",
        "active_rule_count": "",
        "enabled_rule_count": "",
        "rules": [
          {
            "uuid": "",
            "account_uuid": "",
            "shared_account_uuids": "",
            "run_account_uuids": "",
            "name": "",
            "category": "",
            "query_signature": "",
            "description": "",
            "severity": "",
            "confidence": "",
            "auto_resolution_minutes": "",
            "enabled": "",
            "created_user_uuid": "",
            "created": "",
            "updated_user_uuid": "",
            "updated": "",
            "critical_updated": "",
            "primary_attack_id": "",
            "secondary_attack_id": "",
            "specificity": "",
            "rule_accounts": [
              {
                "account_uuid": "",
                "query_filter": "",
                "muted": "",
                "muted_comment": "",
                "muted_user_uuid": "",
                "muted_timestamp": "",
                "detection_count": "",
                "detection_muted_count": "",
                "detection_resolved_count": "",
                "first_seen": "",
                "last_seen": ""
              }
            ],
            "device_ip_fields": [],
            "indicator_fields": [],
            "source_excludes": []
          }
        ],
        "accounts": [
          {
            "uuid": "",
            "name": ""
          }
        ],
        "sort_by": "",
        "sort_order": "",
        "offset": "",
        "limit": ""
      }
    },
    {
      "operation": "get_detection_rule_details",
      "title": "Get Detection Rule Details",
      "description": "Retrieves information for a specific detection rule from FortiNDR Cloud based on the rule UUID and rule account UUID (optional) you have specified.",
      "category": "investigation",
      "annotation": "get_detection_rules",
      "enabled": true,
      "parameters": [
        {
          "title": "Rule UUID",
          "description": "Specify the UUID of the rule based on which you want to retrieve the detection rule details from FortiNDR Cloud.\nNote: The response of the \"Get Detection Rules List\" action contains the UUID of a rule.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "rule_uuid",
          "tooltip": "Only include rule sub-objects for a specific account. Note: Get \"Rule UUID\" value from \"Get All Detections List\" operation response."
        },
        {
          "title": "Rule Account UUID",
          "tooltip": "Only include sub-objects for the specified account.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "rule_account_uuid",
          "description": "(Optional) Specify the UUID of the rule account only if you want to include sub-objects for the specified account while retrieving detection rule details from FortiNDR Cloud."
        }
      ],
      "output_schema": {
        "rule": {
          "uuid": "",
          "account_uuid": "",
          "shared_account_uuids": "",
          "run_account_uuids": "",
          "name": "",
          "category": "",
          "query_signature": "",
          "description": "",
          "severity": "",
          "confidence": "",
          "auto_resolution_minutes": "",
          "enabled": "",
          "created_user_uuid": "",
          "created": "",
          "updated_user_uuid": "",
          "updated": "",
          "critical_updated": "",
          "primary_attack_id": "",
          "secondary_attack_id": "",
          "specificity": "",
          "rule_accounts": [
            {
              "account_uuid": "",
              "query_filter": "",
              "muted": "",
              "muted_comment": "",
              "muted_user_uuid": "",
              "muted_timestamp": "",
              "detection_count": "",
              "detection_muted_count": "",
              "detection_resolved_count": "",
              "first_seen": "",
              "last_seen": ""
            }
          ],
          "device_ip_fields": [],
          "indicator_fields": [],
          "source_excludes": []
        },
        "accounts": [
          {
            "uuid": "",
            "name": ""
          }
        ]
      }
    },
    {
      "operation": "get_detection_rule_events",
      "title": "Get Detection Rule Events List",
      "description": "Retrieves a list of all events for a specific detection rule from FortiNDR Cloud based on the rule UUID and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_detection_rule_events",
      "enabled": true,
      "parameters": [
        {
          "title": "Rule UUID",
          "description": "Specify the UUID of the rule based on which you want to retrieve detection rule events from FortiNDR cloud.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "rule_uuid",
          "tooltip": "Specify the UUID of the rule based on which you want to retrieve detection rule events from FortiNDR cloud. Note: Get \"Rule UUID\" value from \"Get All Detections List\" operation response."
        },
        {
          "title": "Limit",
          "description": "(Optional) Specify the maximum number of results, per page, that this operation should return. By default, this option is set as 100.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "value": 100,
          "tooltip": "The maximum number of records to return. By default, this option is set as 100"
        },
        {
          "title": "Offset",
          "description": "(Optional) Index of the first item to be returned by this operation. This parameter is useful for pagination and for getting a subset of items. By default, this is set as 0.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "offset",
          "value": 0,
          "tooltip": "The number of records to skip past. By default, this option is set as 0"
        }
      ],
      "output_schema": {
        "result_count": "",
        "total_count": "",
        "events": [
          {
            "event_type": "",
            "uuid": "",
            "customer_id": "",
            "sensor_id": "",
            "timestamp": "",
            "flow_id": "",
            "src": {
              "ip": "",
              "port": "",
              "ip_bytes": "",
              "pkts": "",
              "geo": "",
              "asn": "",
              "internal": ""
            },
            "dst": {
              "ip": "",
              "port": "",
              "ip_bytes": "",
              "pkts": "",
              "geo": "",
              "asn": "",
              "internal": ""
            },
            "geo_distance": "",
            "intel": "",
            "source": "",
            "evidence_end_timestamp": "",
            "evidence_iql": "",
            "evidence_start_timestamp": "",
            "observation_category": "",
            "observation_class": "",
            "observation_confidence": "",
            "observation_context": "",
            "observation_title": "",
            "observation_uuid": "",
            "sensor_ids": []
          }
        ]
      }
    }
  ]
}